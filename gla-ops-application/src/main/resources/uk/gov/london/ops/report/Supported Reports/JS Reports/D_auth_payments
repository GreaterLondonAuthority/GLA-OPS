select distinct  pl.vendor_name   Payee,  pl.project_id,  pl.wbs_code, pl.sap_vendor_id, pl.category      payment_category,  pl.sub_category  payment_subcategory, pl.ledger_status status, sum(case when pl.ledger_type = 'PAYMENT' THEN (pl.amount*-1) else 0 end)  grant_total, sum(case when pl.ledger_type = 'RCGF' THEN (pl.amount*-1) else 0 end)     rcgf_total, sum(case when pl.ledger_type = 'DPF' THEN (pl.amount*-1) else 0 end)      dpf_total,  cast(pl.authorised_on as date) authorised_on , pl.authorised_by, pl.invoice_filename
from project_ledger_entry pl
where  pl.ledger_status  not in ('Pending', 'Declined')  and sub_category not like 'Reclaim%'  group by  pl.vendor_name,  pl.project_id, pl.wbs_code, pl.sap_vendor_id, pl.category,  pl.sub_category, pl.ledger_status, cast(pl.authorised_on as date), pl.authorised_by, pl.invoice_filename