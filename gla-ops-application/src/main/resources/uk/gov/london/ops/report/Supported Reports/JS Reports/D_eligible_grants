select distinct  pj.id, coalesce(gs.total_requested,0) project_total_requested_grant,  coalesce(ten.eligible_grant,0) + coalesce(inc.inc_units * ten1.grant_per_unit,0) + coalesce(ten2.grant_requested,0) + coalesce(ten3.eligible_grant3,0) project_total_eligible_grant   from project pj inner join project_block pb on pj.id = pb.project_id  and pb.reporting_version ='true'  left join programme pg on pj.programme_id = pg.id  left join ( select * from ( select distinct  pb.id, pb.project_id,  pb.block_display_name, coalesce(gs.rcgf_value,0) + coalesce(gs.dpf_value,0) + coalesce(gs.grant_value,0) total_requested    from project_block pb      inner join grant_source_block gs on pb.id = gs.id  where pb.reporting_version ='true' and pb.block_type = 'GRANT_SOURCE' ) a where a.total_requested <> 0 )gs on pj.id = gs.project_id     left join (   select * from ( select distinct  pb.id, pb.project_id,  pb.block_display_name, sum(case when coalesce(ten.total_units,0) = coalesce(ten.s106_units,0) then 0 else eligible_grant end) eligible_grant      from project_block pb inner join project pj on pb.project_id = pj.id  inner join tenure_and_units ten on pb.id = ten.block_id  where  pb.reporting_version ='true' and pb.block_type = 'CALCULATE' group by pb.id,  pb.project_id,  pb.block_display_name   ) a  )ten on pj.id = ten.project_id    left join (   select * from ( select distinct  pb.id, pb.project_id,  pb.block_display_name, coalesce(grant_per_unit,0) grant_per_unit      from project_block pb inner join project pj on pb.project_id = pj.id  inner join tenure_and_units ten on pb.id = ten.block_id  where  pb.reporting_version ='true' and pb.block_type = 'Indicative'     ) a  )ten1 on pj.id = ten1.project_id      left join ( select * from ( select distinct  pb.project_id,  grant_per_unit, sum(inc.units) inc_units from project_block pb  inner join tenure_and_units ten on pb.id = ten.block_id and pb.reporting_version ='true' and pb.block_type = 'Indicative'  inner join indicative_tenure_value inc on ten.id = inc.tenure_units_id and inc.units <> 0 left join  template_tenure_type ty on ten.tenure_type_id = ty.id group by  pb.project_id,grant_per_unit ) a  )inc on pj.id = inc.project_id    left join (   select * from ( select distinct  pb.id, pb.project_id,  sum(coalesce(ten.grant_requested,0)) grant_requested    from project_block pb inner join project pj on pb.project_id = pj.id  inner join tenure_and_units ten on pb.id = ten.block_id  where ten.grant_requested is not null and pb.reporting_version ='true' and  pb.block_type = 'NEGOTIATED' group by pb.id,  pb.project_id   ) a where a.grant_requested <> 0 )ten2 on pj.id = ten2.project_id     left join (   select * from ( select distinct  pb.id, pb.project_id,  pb.block_display_name, sum(case when ten.s106_units is not null and ten.s106_units <> 0 then ten.eligible_grant else 0 end )  eligible_grant3       from project_block pb inner join project pj on pb.project_id = pj.id  inner join tenure_and_units ten on pb.id = ten.block_id  where  pb.reporting_version ='true' and  pb.block_type = 'DEVELOPER-LED' group by pb.id,  pb.project_id,  pb.block_display_name ) a  )ten3 on pj.id = ten3.project_id