select distinct  orga.org_id          		strategic_org_id,   orga.pg_id,   orga.pg_name     		    strategic_programme_name,  org.project_count   		strategic_project_count,  org.grant_requested   		strategic_grant_requested, org.rcgf_requested    		strategic_RCGF_requested, org.dpf_requested     		strategic_DPF_requested, org.project_requested_total + asso.associated_amt  strategic_total_requested,  org.grant_approved           strategic_grant_approved, org.rcgf_approved            strategic_RCGF_approved, org.dpf_approved             strategic_DPF_approved, org.project_approved_total   strategic_total_approved,  org.grant_paid               strategic_grant_paid, org.rcgf_paid                strategic_rcgf_paid,  org.dpf_paid                 strategic_dpf_paid, org.payment_total + sos.associated_sos_amt           strategic_total_paid,  asso.associated_amt associated_requested, sos.associated_sos_amt associated_sos,  org.project_requested_total - asso.associated_amt variance_requested, org.payment_total - sos.associated_sos_amt variance_sos    from   v_payments_and_requested_grant_values org    right join ( 	 select *  from ( select distinct  org.id org_id, org.name org_name, pg.id pg_id, pg.name pg_name    from  project pj  inner join programme pg on pj.programme_id = pg.id inner join organisation org on pj.org_id = org.id where pj.status = 'Active' ) a ) orga on orga.org_id = org.org_id and org.programme_id = orga.pg_id and strategic_project = 'true'   left join ( 	 select *  from ( select distinct  org.id org_id, pg.id pg_id, pg.name, sum(coalesce(gs.strategic_funding,0)) associated_amt     from project_block pb    inner join grant_source_block gs on pb.id = gs.id inner join project pj on pb.project_id = pj.id left join programme pg on pj.programme_id = pg.id left join organisation org on pj.org_id = org.id where pb.reporting_version ='true'and pb.block_display_name = 'Grant Source' and gs.associated_project = 'true' and pj.status = 'Active' group by org.id, pg.id  ) a ) asso on asso.org_id = orga.org_id and orga.pg_id = asso.pg_id   left join ( 	 select *  from ( select distinct  org.id org_id, pg.id pg_id,  sum(coalesce(gs.strategic_funding,0)) associated_sos_amt    from project_block pb    inner join grant_source_block gs on pb.id = gs.id inner join project pj on pb.project_id = pj.id left join programme pg on pj.programme_id = pg.id left join organisation org on pj.org_id = org.id  inner join ( select * from ( select distinct  pb.project_id,  mi.summary sos from project_block pb inner join milestone mi on pb.id = mi.milestones_block where mi.summary in ('Start on site','Start on Site') and mi.claim_status = 'Approved' and pb.block_status in ('APPROVED','LAST_APPROVED')  ) a  ) sos1 on pj.id = sos1.project_id  where pb.reporting_version ='true'and pb.block_display_name = 'Grant Source' and gs.associated_project = 'true' and pj.status = 'Active' group by org.id, pg.id  ) a ) sos on sos.org_id = orga.org_id and orga.pg_id = sos.pg_id