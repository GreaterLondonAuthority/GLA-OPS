select distinct  pj.id project_id,  pg.name programme , pj.status, pj.substatus,  q.answer other_affordable_type,  coalesce(cal_tot_unit,0) + coalesce(neg_tot_unit,0) + coalesce(dev_tot_unit,0) + coalesce(inc_tot_unit,0) tot_units, coalesce(cal_tot_cost,0) + coalesce(neg_tot_cost,0) + coalesce(dev_tot_cost,0) tot_costs, coalesce(cal_tot_grant,0) + coalesce(neg_tot_grant,0) + coalesce(dev_tot_grant,0) + coalesce(inc_tot_grant,0) tot_grant, coalesce(s106_tot_unit,0)  tot_s106,  coalesce(nil_grant_units,0) nil_grant_units, coalesce(s106_units1,0) lar_s106_units, coalesce(s106_units2,0) llr_s106_units, coalesce(s106_units3,0) lso_s106_units, coalesce(s106_units4,0) oa_s106_units, coalesce(s106_units5,0) legacy_ar_s106_units, coalesce(s106_units6,0) legacy_aho_s106_units, coalesce(s106_units7,0) legacy_so_s106_units, coalesce(s106_units8,0) sr_s106_units, coalesce(s106_units9,0) lar_sr_s106_units, coalesce(s106_units10,0) llr_so_s106_units, coalesce(s106_units11,0) int_rent_s106_units, coalesce(s106_units12,0) int_ho_s106_units,  coalesce(cal_units1,0)+coalesce(neg_units1,0)+coalesce(dev_units1,0)+coalesce(inc_units1,0) lar_units, coalesce(cal_units2,0)+coalesce(neg_units2,0)+coalesce(dev_units2,0)+coalesce(inc_units2,0) llr_units, coalesce(cal_units3,0)+coalesce(neg_units3,0)+coalesce(dev_units3,0)+coalesce(inc_units3,0) lso_units, coalesce(cal_units4,0)+coalesce(neg_units4,0)+coalesce(dev_units4,0)+coalesce(inc_units4,0) oa_units, coalesce(cal_units5,0)+coalesce(neg_units5,0)+coalesce(dev_units5,0)+coalesce(inc_units5,0) legacy_ar_units, coalesce(cal_units6,0)+coalesce(neg_units6,0)+coalesce(dev_units6,0)+coalesce(inc_units6,0) legacy_aho_units, coalesce(cal_units7,0)+coalesce(neg_units7,0)+coalesce(dev_units7,0)+coalesce(inc_units7,0) legacy_so_units, coalesce(cal_units8,0)+coalesce(neg_units8,0)+coalesce(dev_units8,0)+coalesce(inc_units8,0) sr_units, coalesce(cal_units9,0)+coalesce(neg_units9,0)+coalesce(dev_units9,0)+coalesce(inc_units9,0) lar_sr_units, coalesce(cal_units10,0)+coalesce(neg_units10,0)+coalesce(dev_units10,0)+coalesce(inc_units10,0) llr_so_units, coalesce(cal_units11,0)+coalesce(neg_units11,0)+coalesce(dev_units11,0)+coalesce(inc_units11,0) int_rent_units, coalesce(cal_units12,0)+coalesce(neg_units12,0)+coalesce(dev_units12,0)+coalesce(inc_units12,0) int_ho_units,  coalesce(cal_cost1,0)+coalesce(neg_cost1,0)+coalesce(dev_cost1,0) lar_costs, coalesce(cal_cost2,0)+coalesce(neg_cost2,0)+coalesce(dev_cost2,0) llr_costs, coalesce(cal_cost3,0)+coalesce(neg_cost3,0)+coalesce(dev_cost3,0) lso_costs, coalesce(cal_cost4,0)+coalesce(neg_cost4,0)+coalesce(dev_cost4,0) oa_costs, coalesce(cal_cost5,0)+coalesce(neg_cost5,0)+coalesce(dev_cost5,0) legacy_ar_costs, coalesce(cal_cost6,0)+coalesce(neg_cost6,0)+coalesce(dev_cost6,0) legacy_aho_costs, coalesce(cal_cost7,0)+coalesce(neg_cost7,0)+coalesce(dev_cost7,0) legacy_so_costs, coalesce(cal_cost8,0)+coalesce(neg_cost8,0)+coalesce(dev_cost8,0) sr_costs, coalesce(cal_cost9,0)+coalesce(neg_cost9,0)+coalesce(dev_cost9,0) lar_sr_costs, coalesce(cal_cost10,0)+coalesce(neg_cost10,0)+coalesce(dev_cost10,0) llr_so_costs, coalesce(cal_cost11,0)+coalesce(neg_cost11,0)+coalesce(dev_cost11,0) int_rent_costs, coalesce(cal_cost12,0)+coalesce(neg_cost12,0)+coalesce(dev_cost12,0) int_ho_costs,  coalesce(cal_grant1,0)+coalesce(neg_grant1,0)+coalesce(dev_grant1,0)+coalesce(inc_grant1,0) lar_grants, coalesce(cal_grant2,0)+coalesce(neg_grant2,0)+coalesce(dev_grant2,0)+coalesce(inc_grant2,0) llr_grants, coalesce(cal_grant3,0)+coalesce(neg_grant3,0)+coalesce(dev_grant3,0)+coalesce(inc_grant3,0) lso_grants, coalesce(cal_grant4,0)+coalesce(neg_grant4,0)+coalesce(dev_grant4,0)+coalesce(inc_grant4,0) oa_grants, coalesce(cal_grant5,0)+coalesce(neg_grant5,0)+coalesce(dev_grant5,0)+coalesce(inc_grant5,0) legacy_ar_grants, coalesce(cal_grant6,0)+coalesce(neg_grant6,0)+coalesce(dev_grant6,0)+coalesce(inc_grant6,0) legacy_aho_grants, coalesce(cal_grant7,0)+coalesce(neg_grant7,0)+coalesce(dev_grant7,0)+coalesce(inc_grant7,0) legacy_so_grants, coalesce(cal_grant8,0)+coalesce(neg_grant8,0)+coalesce(dev_grant8,0)+coalesce(inc_grant8,0) sr_grants, coalesce(cal_grant9,0)+coalesce(neg_grant9,0)+coalesce(dev_grant9,0)+coalesce(inc_grant9,0) lar_sr_grants, coalesce(cal_grant10,0)+coalesce(neg_grant10,0)+coalesce(dev_grant10,0)+coalesce(inc_grant10,0) llr_so_grants, coalesce(cal_grant11,0)+coalesce(neg_grant11,0)+coalesce(dev_grant11,0)+coalesce(inc_grant11,0) int_rent_grants, coalesce(cal_grant12,0)+coalesce(neg_grant12,0)+coalesce(dev_grant12,0)+coalesce(inc_grant12,0) int_ho_grants  from  project pj  left join programme pg on pj.programme_id = pg.id   left join ( select * from ( select distinct  pb.project_id, pb.last_modified mod ,    sum(case when ty.external_id ='4000' then coalesce(ten.total_units,0) else 0 end) cal_units1,  sum(case when ty.external_id ='4001' then coalesce(ten.total_units,0) else 0 end) cal_units2,  sum(case when ty.external_id ='4002' then coalesce(ten.total_units,0) else 0 end) cal_units3,  sum(case when ty.external_id ='4003' then coalesce(ten.total_units,0) else 0 end) cal_units4, sum(case when ty.external_id ='4004' then coalesce(ten.total_units,0) else 0 end) cal_units5,  sum(case when ty.external_id ='4005' then coalesce(ten.total_units,0) else 0 end) cal_units6,  sum(case when ty.external_id ='4006' then coalesce(ten.total_units,0) else 0 end) cal_units7,  sum(case when ty.external_id ='4009' then coalesce(ten.total_units,0) else 0 end) cal_units8,    sum(case when ty.external_id ='4010' then coalesce(ten.total_units,0) else 0 end) cal_units9,  sum(case when ty.external_id ='4011' then coalesce(ten.total_units,0) else 0 end) cal_units10, sum(case when ty.external_id ='4012' then coalesce(ten.total_units,0) else 0 end) cal_units11, sum(case when ty.external_id ='4015' then coalesce(ten.total_units,0) else 0 end) cal_units12,    sum(case when ty.external_id ='4000' then coalesce(ten.total_cost,0) else 0 end) cal_cost1,  sum(case when ty.external_id ='4001' then coalesce(ten.total_cost,0) else 0 end) cal_cost2,  sum(case when ty.external_id ='4002' then coalesce(ten.total_cost,0) else 0 end) cal_cost3,  sum(case when ty.external_id ='4003' then coalesce(ten.total_cost,0) else 0 end) cal_cost4, sum(case when ty.external_id ='4004' then coalesce(ten.total_cost,0) else 0 end) cal_cost5,  sum(case when ty.external_id ='4005' then coalesce(ten.total_cost,0) else 0 end) cal_cost6,  sum(case when ty.external_id ='4006' then coalesce(ten.total_cost,0) else 0 end) cal_cost7,  sum(case when ty.external_id ='4009' then coalesce(ten.total_cost,0) else 0 end) cal_cost8,    sum(case when ty.external_id ='4010' then coalesce(ten.total_cost,0) else 0 end) cal_cost9,  sum(case when ty.external_id ='4011' then coalesce(ten.total_cost,0) else 0 end) cal_cost10,  sum(case when ty.external_id ='4012' then coalesce(ten.total_cost,0) else 0 end) cal_cost11,  sum(case when ty.external_id ='4015' then coalesce(ten.total_cost,0) else 0 end) cal_cost12,     sum(case when ty.external_id ='4000' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant1,  sum(case when ty.external_id ='4001' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant2,  sum(case when ty.external_id ='4002' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant3,  sum(case when ty.external_id ='4003' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant4, sum(case when ty.external_id ='4004' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant5,  sum(case when ty.external_id ='4005' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant6,  sum(case when ty.external_id ='4006' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant7,  sum(case when ty.external_id ='4009' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant8,    sum(case when ty.external_id ='4010' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant9,  sum(case when ty.external_id ='4011' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant10, sum(case when ty.external_id ='4012' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant11, sum(case when ty.external_id ='4015' then coalesce(ten.eligible_grant,0) else 0 end) cal_grant12,    sum(coalesce(ten.s106_units,0)) nil_grant_units, sum(coalesce(ten.total_units,0)) cal_tot_unit, sum(coalesce(ten.total_cost,0))  cal_tot_cost, sum(coalesce(ten.eligible_grant,0))  cal_tot_grant      from project_block pb  inner join tenure_and_units ten on pb.id = ten.block_id  inner join  template_tenure_type ty on ten.tenure_type_id = ty.id where  pb.block_type = 'CALCULATE' and pb.reporting_version = 'true' group by pb.project_id, pb.last_modified ) a    )cal on pj.id = cal.project_id    left join ( select * from ( select distinct  pb.project_id, pb.last_modified mod ,    sum(case when ty.external_id ='4000' then coalesce(ten.total_units,0) else 0 end) neg_units1,  sum(case when ty.external_id ='4001' then coalesce(ten.total_units,0) else 0 end) neg_units2,  sum(case when ty.external_id ='4002' then coalesce(ten.total_units,0) else 0 end) neg_units3,  sum(case when ty.external_id ='4003' then coalesce(ten.total_units,0) else 0 end) neg_units4, sum(case when ty.external_id ='4004' then coalesce(ten.total_units,0) else 0 end) neg_units5,  sum(case when ty.external_id ='4005' then coalesce(ten.total_units,0) else 0 end) neg_units6,  sum(case when ty.external_id ='4006' then coalesce(ten.total_units,0) else 0 end) neg_units7,  sum(case when ty.external_id ='4009' then coalesce(ten.total_units,0) else 0 end) neg_units8,    sum(case when ty.external_id ='4010' then coalesce(ten.total_units,0) else 0 end) neg_units9,  sum(case when ty.external_id ='4011' then coalesce(ten.total_units,0) else 0 end) neg_units10, sum(case when ty.external_id ='4012' then coalesce(ten.total_units,0) else 0 end) neg_units11, sum(case when ty.external_id ='4015' then coalesce(ten.total_units,0) else 0 end) neg_units12,    sum(case when ty.external_id ='4000' then coalesce(ten.total_cost,0) else 0 end) neg_cost1,  sum(case when ty.external_id ='4001' then coalesce(ten.total_cost,0) else 0 end) neg_cost2,  sum(case when ty.external_id ='4002' then coalesce(ten.total_cost,0) else 0 end) neg_cost3,  sum(case when ty.external_id ='4003' then coalesce(ten.total_cost,0) else 0 end) neg_cost4, sum(case when ty.external_id ='4004' then coalesce(ten.total_cost,0) else 0 end) neg_cost5,  sum(case when ty.external_id ='4005' then coalesce(ten.total_cost,0) else 0 end) neg_cost6,  sum(case when ty.external_id ='4006' then coalesce(ten.total_cost,0) else 0 end) neg_cost7,  sum(case when ty.external_id ='4009' then coalesce(ten.total_cost,0) else 0 end) neg_cost8,    sum(case when ty.external_id ='4010' then coalesce(ten.total_cost,0) else 0 end) neg_cost9,  sum(case when ty.external_id ='4011' then coalesce(ten.total_cost,0) else 0 end) neg_cost10,   sum(case when ty.external_id ='4012' then coalesce(ten.total_cost,0) else 0 end) neg_cost11, sum(case when ty.external_id ='4015' then coalesce(ten.total_cost,0) else 0 end) neg_cost12,    sum(case when ty.external_id ='4000' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant1,  sum(case when ty.external_id ='4001' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant2,  sum(case when ty.external_id ='4002' then (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant3,  sum(case when ty.external_id ='4003' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant4, sum(case when ty.external_id ='4004' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant5,  sum(case when ty.external_id ='4005' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant6,   sum(case when ty.external_id ='4006' then (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant7,  sum(case when ty.external_id ='4009' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant8, sum(case when ty.external_id ='4010' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant9,  sum(case when ty.external_id ='4011' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant10,  sum(case when ty.external_id ='4012' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant11, sum(case when ty.external_id ='4015' then  (case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end) else 0 end) neg_grant12,  sum(coalesce(ten.total_units,0)) neg_tot_unit, sum(coalesce(ten.total_cost,0))  neg_tot_cost, sum(case when coalesce(ten.eligible_grant,0) = 0 then coalesce(ten.grant_requested,0) else coalesce(ten.eligible_grant,0) end)  neg_tot_grant      from project_block pb inner join tenure_and_units ten on pb.id = ten.block_id  inner join  template_tenure_type ty on ten.tenure_type_id = ty.id where  pb.block_type = 'NEGOTIATED'  and pb.reporting_version = 'true' group by pb.project_id, pb.last_modified  ) a  )neg on pj.id = neg.project_id   left join (   select * from ( select distinct  pb.project_id, pb.last_modified mod,    sum(case when ty.external_id ='4000' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units1,  sum(case when ty.external_id ='4001' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units2,  sum(case when ty.external_id ='4002' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units3,  sum(case when ty.external_id ='4003' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units4, sum(case when ty.external_id ='4004' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units5,  sum(case when ty.external_id ='4005' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units6,  sum(case when ty.external_id ='4006' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units7,  sum(case when ty.external_id ='4009' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units8,  sum(case when ty.external_id ='4010' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units9, sum(case when ty.external_id ='4011' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units10, sum(case when ty.external_id ='4012' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units11, sum(case when ty.external_id ='4015' then coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0) else 0 end) dev_units12,        sum(case when ty.external_id ='4000' then coalesce(ten.s106_units,0) else 0 end) s106_units1,  sum(case when ty.external_id ='4001' then coalesce(ten.s106_units,0) else 0 end) s106_units2,  sum(case when ty.external_id ='4002' then coalesce(ten.s106_units,0) else 0 end) s106_units3,  sum(case when ty.external_id ='4003' then coalesce(ten.s106_units,0) else 0 end) s106_units4, sum(case when ty.external_id ='4004' then coalesce(ten.s106_units,0) else 0 end) s106_units5,  sum(case when ty.external_id ='4005' then coalesce(ten.s106_units,0) else 0 end) s106_units6,  sum(case when ty.external_id ='4006' then coalesce(ten.s106_units,0) else 0 end) s106_units7,  sum(case when ty.external_id ='4009' then coalesce(ten.s106_units,0) else 0 end) s106_units8,  sum(case when ty.external_id ='4010' then coalesce(ten.s106_units,0) else 0 end) s106_units9, sum(case when ty.external_id ='4011' then coalesce(ten.s106_units,0) else 0 end) s106_units10,  sum(case when ty.external_id ='4012' then coalesce(ten.s106_units,0) else 0 end) s106_units11,      sum(case when ty.external_id ='4015' then coalesce(ten.s106_units,0) else 0 end) s106_units12,       sum(case when ty.external_id ='4000' then coalesce(ten.total_cost,0) else 0 end) dev_cost1,  sum(case when ty.external_id ='4001' then coalesce(ten.total_cost,0) else 0 end) dev_cost2,  sum(case when ty.external_id ='4002' then coalesce(ten.total_cost,0) else 0 end) dev_cost3,  sum(case when ty.external_id ='4003' then coalesce(ten.total_cost,0) else 0 end) dev_cost4, sum(case when ty.external_id ='4004' then coalesce(ten.total_cost,0) else 0 end) dev_cost5,  sum(case when ty.external_id ='4005' then coalesce(ten.total_cost,0) else 0 end) dev_cost6,  sum(case when ty.external_id ='4006' then coalesce(ten.total_cost,0) else 0 end) dev_cost7,  sum(case when ty.external_id ='4009' then coalesce(ten.total_cost,0) else 0 end) dev_cost8,    sum(case when ty.external_id ='4010' then coalesce(ten.total_cost,0) else 0 end) dev_cost9,  sum(case when ty.external_id ='4011' then coalesce(ten.total_cost,0) else 0 end) dev_cost10,   sum(case when ty.external_id ='4012' then coalesce(ten.total_cost,0) else 0 end) dev_cost11,   sum(case when ty.external_id ='4015' then coalesce(ten.total_cost,0) else 0 end) dev_cost12,       sum(case when ty.external_id ='4000' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant1,  sum(case when ty.external_id ='4001' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant2,  sum(case when ty.external_id ='4002' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant3,  sum(case when ty.external_id ='4003' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant4, sum(case when ty.external_id ='4004' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant5,  sum(case when ty.external_id ='4005' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant6,  sum(case when ty.external_id ='4006' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant7,  sum(case when ty.external_id ='4009' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant8,    sum(case when ty.external_id ='4010' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant9,  sum(case when ty.external_id ='4011' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant10, sum(case when ty.external_id ='4012' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant11, sum(case when ty.external_id ='4015' then coalesce(ten.eligible_grant,0) else 0 end) dev_grant12,      sum(coalesce(ten.s106_units,0))   s106_tot_unit, sum(coalesce(ten.s106_units,0)+ coalesce(ten.additional_units,0)) dev_tot_unit, sum(coalesce(ten.total_cost,0))  dev_tot_cost, sum(coalesce(ten.eligible_grant,0))  dev_tot_grant      from project_block pb  inner join tenure_and_units ten on pb.id = ten.block_id  inner join  template_tenure_type ty on ten.tenure_type_id = ty.id where  pb.block_type = 'DEVELOPER-LED'  and pb.reporting_version = 'true' group by pb.project_id, pb.last_modified ) a  )dev on pj.id = dev.project_id   left join ( select * from ( select distinct  pb.project_id,  sum(inc.units) inc_tot_unit, sum(coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0)) inc_tot_grant,    sum(case when ty.external_id ='4000' then coalesce(inc.units,0) else 0 end) inc_units1,  sum(case when ty.external_id ='4001' then coalesce(inc.units,0) else 0 end) inc_units2,  sum(case when ty.external_id ='4002' then coalesce(inc.units,0) else 0 end) inc_units3,  sum(case when ty.external_id ='4003' then coalesce(inc.units,0) else 0 end) inc_units4, sum(case when ty.external_id ='4004' then coalesce(inc.units,0) else 0 end) inc_units5,  sum(case when ty.external_id ='4005' then coalesce(inc.units,0) else 0 end) inc_units6,  sum(case when ty.external_id ='4006' then coalesce(inc.units,0) else 0 end) inc_units7,  sum(case when ty.external_id ='4009' then coalesce(inc.units,0) else 0 end) inc_units8,  sum(case when ty.external_id ='4010' then coalesce(inc.units,0) else 0 end) inc_units9, sum(case when ty.external_id ='4011' then coalesce(inc.units,0) else 0 end) inc_units10, sum(case when ty.external_id ='4012' then coalesce(inc.units,0) else 0 end) inc_units11,  sum(case when ty.external_id ='4015' then coalesce(inc.units,0) else 0 end) inc_units12,     sum(case when ty.external_id ='4000' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant1,  sum(case when ty.external_id ='4001' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant2,  sum(case when ty.external_id ='4002' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant3,  sum(case when ty.external_id ='4003' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant4, sum(case when ty.external_id ='4004' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant5,  sum(case when ty.external_id ='4005' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant6,  sum(case when ty.external_id ='4006' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant7,  sum(case when ty.external_id ='4009' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant8,  sum(case when ty.external_id ='4010' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant9, sum(case when ty.external_id ='4011' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant10, sum(case when ty.external_id ='4012' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant11, sum(case when ty.external_id ='4015' then coalesce(inc.units,0) * coalesce(ten.grant_per_unit,0) else 0 end) inc_grant12    from project_block pb   inner join tenure_and_units ten on pb.id = ten.block_id  inner join  template_tenure_type ty on ten.tenure_type_id = ty.id inner join indicative_tenure_value inc on ten.id = inc.tenure_units_id  where pb.block_type = 'Indicative'  and pb.reporting_version = 'true' group by pb.project_id ) a  )inc on pj.id = inc.project_id   left join ( select * from ( select distinct  pb.project_id, an.answer from project_block pb   inner join answer an on pb.id = an.questions_block  where pb.block_type = 'QUESTIONS' and an.question_id ='501'  and left(an.answer,3) <> 'N/A' ) a  )q on pj.id = q.project_id