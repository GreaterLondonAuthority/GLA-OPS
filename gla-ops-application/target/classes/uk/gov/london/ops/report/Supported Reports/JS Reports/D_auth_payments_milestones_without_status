select distinct      pl.project_id milestone_payment_nostatus_project_id,     case when left(sub_category,7) = 'Bespoke' then substring(sub_category, 9,50) else  case when left(sub_category,9) = 'Reclaimed' then substring(sub_category,11,50) else sub_category end end  milestone_payment_nostatus_sub_category,   sum(case when pl.ledger_type = 'PAYMENT' THEN (pl.amount*-1) else 0 end)  milestone_payment_nostatus_grant,    sum(case when pl.ledger_type = 'RCGF' THEN (pl.amount*-1) else 0 end)      milestone_payment_nostatus_rcgf,    sum(case when pl.ledger_type = 'DPF' THEN (pl.amount*-1) else 0 end)       milestone_payment_nostatus_dpf,     cast(pl.authorised_on as date) milestone_payment_nostatus_authorised_on,   pl.authorised_by milestone_payment_nostatus_authorised_by,      case when cast(substring(to_char(cast(pl.authorised_on as date),'DD/MM/YYYY'),4,2) as int) in ('1','2','3')  then   text(cast(right(to_char(cast(pl.authorised_on as date),'DD/MM/YYYY'),4) as int)-1)||'-'||text(cast(right(to_char(cast(pl.authorised_on as date),'DD/MM/YYYY'),4) as int))   else  text(cast(right(to_char(cast(pl.authorised_on as date),'DD/MM/YYYY'),4) as int))||'-'||text(cast(right(to_char(cast(pl.authorised_on as date),'DD/MM/YYYY'),4) as int)+1)   end milestone_payment_nostatus_financial_year
from project_ledger_entry pl
where  pl.sub_category is not null   and   pl.ledger_status not in ( 'Declined','Pending' )   and left(sub_category,9) <> 'Reclaimed'   group by  pl.project_id,  pl.sub_category,  cast(pl.authorised_on as date), pl.authorised_by  order by 1