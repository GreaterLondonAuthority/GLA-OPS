select  pj.id project_id,  pjdb.pcs_project_code , unit.tenure_name,  unit.market_type, unit.beds, unit.unitType unit_type,	 unit.nb_units, unit.net_weekly_rent,			 unit.weekly_service_charge,	 coalesce(unit.net_weekly_rent,0) + coalesce(unit.weekly_service_charge,0) total_rents, unit.weekly_market_rent,	 case when coalesce(unit.weekly_market_rent,0) = 0 then  0 else  round((coalesce(unit.net_weekly_rent,0)+coalesce(unit.weekly_service_charge,0))/unit.weekly_market_rent *100,0) end RENT_AS_MARKET_RENT , unit.market_value,			 unit.first_tranche_sales,		 unit.discount_off_market_value,  unit2.new_build_units,	 unit2.refurbished_units	, coalesce(unit2.new_build_units,0) + coalesce(unit2.refurbished_units,0) Total ,  unit2.type_1_units	,		 unit2.type_2_units	,		 unit2.type_3_units	,		 unit2.type_4_units	, unit2.type_5_units	, unit2.type_6_units	,		 unit2.type_7_units	,		 unit2.type_8_units	,		 unit2.nb_wheelchair_units,			 unit2.gross_internal_area      from project pj inner join programme pg on pj.programme_id = pg.id  left join ( 	 select * from ( select distinct  pb.project_id, pb.last_modified pjdb_mod, w.name, pjdb.* from project_block pb inner join project_details_block pjdb on pb.id = pjdb.id left join ward w on pjdb.ward_id = w.id where  pb.block_display_name = 'Project Details' and pb.reporting_version ='true' ) a  )pjdb on pjdb.project_id = pj.id    left join ( 	 select * from ( select   pb.project_id, pb.last_modified unit_mod, u.type, u.tenure_id, ty.name tenure_name,  u.market_type_id,  mk.name market_type,  u.nb_beds_id, bed.display_value beds, u.unit_type_id, cat.display_value unitType, u.nb_units,			 u.net_weekly_rent,			 u.weekly_service_charge,			 u.weekly_market_rent, u.market_value,			 u.first_tranche_sales,		 u.discount_off_market_value      from project_block pb inner join units_table_entry u on u.project_id = pb.project_id and u.block_id = pb.id left join tenure_type ty on u.tenure_id = ty.id  left join market_type mk on u.market_type_id = mk.id  left join category_value cat on cat.id = u.unit_type_id  left join category_value bed on bed.id = u.nb_beds_id where  pb.block_display_name = 'Unit Details' and pb.reporting_version = 'true' and pb.block_status <> 'UNAPPROVED' ) a  )unit on unit.project_id = pj.id    left join ( 	 select * from ( select distinct  pb.project_id, pb.last_modified unit_mod, u.new_build_units,	 u.refurbished_units	, u.type_1_units	,		 u.type_2_units	,		 u.type_3_units	,		 u.type_4_units	,		 u.type_5_units	,		 u.type_6_units	,		 u.type_7_units	,		 u.type_8_units	,		 u.nb_wheelchair_units,			 u.gross_internal_area      from project_block pb inner join unit_details_block u on u.id = pb.id where  pb.block_display_name = 'Unit Details' and pb.reporting_version = 'true' and pb.block_status <> 'UNAPPROVED' ) a  )unit2 on unit2.project_id = pj.id   order by 1,2,3,4,6,7,8