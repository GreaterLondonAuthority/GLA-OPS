<div class="question-form page">

  <page-header on-back="$ctrl.goBack()">Question details</page-header>

  <header-status ng-if="$ctrl.question.id">
    <hs-left class="row text-nowrap" ng-if="$ctrl.question.createdOn && $ctrl.question.creatorName">Created on {{($ctrl.question.createdOn) | date: 'dd/MM/yyyy'}} by {{$ctrl.question.creatorName}}</hs-left>
    <hs-left class="row text-nowrap" ng-if="$ctrl.question.modifiedOn && $ctrl.question.modifierName">Last updated on {{($ctrl.question.modifiedOn) | date: 'dd/MM/yyyy'}} by {{$ctrl.question.modifierName}}</hs-left>
  </header-status>

  <div class="row">
    <div class="col-xs-12 col-sm-8 col-md-6 center-col">
      <form class="mtop40">
        <div class="form-group">
          <label for="id">Question ID</label>
          <input id="id"
                 type="text"
                 class="form-control"
                 placeholder="Question ID"
                 ng-model="$ctrl.question.id"
                 maxlength="9"
                 ng-disabled="$ctrl.$stateParams.questionId" />
        </div>

        <div class="form-group">
          <label for="text">Question text</label>
          <textarea id="text"
                    ng-trim="false"
                    rows="5"
                    placeholder="Enter question text"
                    class="form-control"
                    ng-model="$ctrl.question.text"
                    maxlength="255"></textarea>
          <remaining-characters text="$ctrl.question.text" max="255"></remaining-characters>
        </div>

        <div class="form-group">
          <label for="answer-type">Answer Type</label>
          <ui-select id="answer-type"
                     required
                     ng-model="$ctrl.question.answerType"
                     on-select="$ctrl.onAnserTypeSelect($select.selected)"
                     ng-disabled="false"
                     search-enabled="false">
            <ui-select-match placeholder="Select answer type">
              {{$select.selected}}
            </ui-select-match>
            <ui-select-choices position="auto" repeat="at in $ctrl.answerTypes">
              <span>{{at}}</span>
            </ui-select-choices>
          </ui-select>
        </div>


        <div class="form-group" ng-if="$ctrl.question.answerType === 'FreeText'">
          <label for="maxlength">Maximum character length</label>
          <input id="maxlength"
                 type="text"
                 number-mask="0"
                 class="form-control"
                 placeholder="Maximum character length"
                 ng-model="$ctrl.question.maxLength"
                 maxlength="6"/>
        </div>


        <div class="form-group" ng-if="$ctrl.question.answerType === 'FileUpload'">
          <label for="max-number-of-files">Maximum number of files to upload</label>
          <input id="max-number-of-files"
                 type="text"
                 number-mask="0"
                 class="form-control"
                 placeholder="Maximum number of files to upload"
                 ng-model="$ctrl.question.quantity"
                 maxlength="3"/>
        </div>


        <div class="form-group" ng-if="$ctrl.question.answerType === 'FileUpload'">
          <label for="max-file-size">Maximum file size in MB</label>
          <input id="max-file-size"
                 type="text"
                 number-mask="0"
                 class="form-control"
                 placeholder="Maximum file size in MB"
                 ng-model="$ctrl.question.maxUploadSizeInMb"
                 maxlength="3"/>

        </div>

        <div class="form-group" ng-if="$ctrl.question.answerType === 'Dropdown'" id="dropdown-options">
          <div class="dropdown-options-top">
            <span class="label">Options</span>
            <button class="btn btn-secondary pull-right" ng-click="$ctrl.addNewDropdownOption()">ADD</button>
          </div>
          <div class="dropdown-option delete-btn-container" ng-repeat="option in $ctrl.question.answerOptions track by $index" ng-class="'dropdown-option-' + ($index + 1)">
            <input type="text"
                   aria-label="{{'dropdown option ' + ($index + 1)}}"
                   class="form-control"
                   placeholder="Dropdown option"
                   maxlength="45"
                   ng-model="$ctrl.question.answerOptions[$index].option"/>
            <delete-button ng-click="$ctrl.deleteDropdownOption($index)"></delete-button>
          </div>
         </div>
      </form>

      <!--<per>{{$ctrl.question | json}}</per>-->
    </div>
  </div>

  <div class="text-center mtop40 mbottom40">
    <button class="btn btn-primary"
            ng-disabled="!$ctrl.isQuestionValid($ctrl.question)"
            ng-click="$ctrl.save()">SAVE</button>
  </div>
</div>
